<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫—É–ø–æ–∫ –≤ Google Sheets</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f6f8;
      margin: 0;
      padding: 40px;
    }
    h1 {
      text-align: center;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
      background: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    textarea {
      width: 100%;
      height: 150px;
      font-size: 14px;
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    button {
      width: 100%;
      padding: 10px;
      background: #2d89ef;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      margin-top: 10px;
    }
    button:hover {
      background: #1e5bbf;
    }
    .log {
      margin-top: 20px;
      background: #f9f9f9;
      border: 1px solid #ddd;
      border-radius: 5px;
      padding: 10px;
      height: 150px;
      overflow-y: auto;
      font-family: monospace;
      font-size: 13px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üìÑ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫—É–ø–æ–∫ –≤ Google Sheets</h1>
    <p>–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä–∞ –∑–∞–∫—É–ø–æ–∫ (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É):</p>
    <textarea id="tenderList" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä:&#10;0102200001625001998&#10;0711200020925000018"></textarea>
    <button onclick="uploadTenders()">üöÄ –ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
    <div class="log" id="log"></div>
  </div>

  <script>
    async function uploadTenders() {
      const logBox = document.getElementById('log');
      logBox.innerHTML = "‚è≥ –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤...\n";
      const tenders = document.getElementById('tenderList').value
        .split('\n')
        .map(x => x.trim())
        .filter(Boolean);

      for (const tenderId of tenders) {
        logBox.innerHTML += `üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ ${tenderId}...\n`;
        try {
          const response = await fetch('/get-tender', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ tenderId })
          });
          const data = await response.json();
          if (data.error) {
            logBox.innerHTML += `‚ùå –û—à–∏–±–∫–∞: ${data.error}\n`;
          } else {
            logBox.innerHTML += `‚úÖ –£—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ: ${tenderId}\n`;
          }
        } catch (e) {
          logBox.innerHTML += `‚ö†Ô∏è –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º –¥–ª—è ${tenderId}\n`;
        }
      }
      logBox.innerHTML += "üéØ –ì–æ—Ç–æ–≤–æ!\n";
    }
  </script>
</body>
</html>
